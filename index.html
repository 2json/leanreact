<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Hello React!</title>
 <!--    <script src="http://facebook.github.io/react/js/react.js"></script>
    <script src="http://facebook.github.io/react/js/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script> -->
    <script src="./react-15.0.2/build/react.js"></script>
    <script src="./react-15.0.2/build/react-dom.js"></script>
    <script src="./babel-browser.js"></script>
    <link rel="stylesheet" href="./css/base.css">
    <link rel="stylesheet" href="./css/app.css">
  </head>
  <body class="lean-bar">
    <section id="AppRoot" class="todoapp"></section>
    <script type="text/babel">

/**
 * [todolist 数据]
 * @type {Object}
 */
var todolist = {
    name: "todos",
    todos: [{
        completed: false,
        title: 'finish exercise'
    }, {
        completed: false,
        title: 'lean jsx'
    }, {
        completed: true,
        title: 'lean react'
    }]
};

/**
 * App 组件 
 */

var App = React.createClass({
    getInitialState: function() {
        return {
            todolist: todolist
        }
    },
    render: function() {
        var todolist = this.state.todolist;
        // 计算还有多少个未完成的
        var lefted = todolist.todos.reduce(function(acc, todo) {
            return todo.completed ? acc : acc + 1;
        }, 0);
        return <div>
                    <section className="main">
                        <Header title={todolist.name}/>
                        <TodoList todos={todolist.todos}/>
                        <Footer lefted={lefted}/>
                    </section>
                </div>
    }
});


/**
 * Header 组件
 */

var Header = React.createClass({
    render: function() {
        return <header className="header">
                <h1>{this.props.title}</h1>
                <input className="new-todo" placeholder="What needs to be done?" value=""/>
            </header>
    }
});


/**
 * TodoList
 */
var TodoList = React.createClass({
    render: function() {
        return <ul className="todo-list">
                {this.props.todos.map(function(todo, i) {
                    return <TodoItem data={todo} key={i}/>
                })}
            </ul>
    }
});

/**
 * TodoItem
 */
var TodoItem = React.createClass({
    render: function() {
        var todo = this.props.data;
        var className = "";
        if (todo.completed) {
            className = "completed";
        }
        return <li className={className}>
                <div className="view">
                    <input className="toggle" type="checkbox" checked=""/>
                    <label> {todo.title} </label>
                    <button className="destroy"> </button>
                </div>
                <input tyoe="text" className="edit" value={todo.title} />
            </li>
    }
});

/**
 * Footer
 */
var Footer = React.createClass({
    render: function() {
        return <footer className="footer">
            <span className="todo-count">
                <strong> {this.props.lefted} </strong> <span> </span> <span> items </span> <span> left </span>
            </span>
            <ul className="filters">
                <li> <a href="#/" className="selected"> All </a> </li>
                <li> <a href="#/active" className=""> Active </a> </li> 
                <li> <a href="#/completed" className=""> Completed </a> </li>
            </ul>
            <button className="clear-completed">
                Clear completed
            </button>
        </footer>
    }
})
 

/**
 * render 到 DOM
 * @type {String}
 */
ReactDOM.render(
  <App />,
  document.getElementById('AppRoot')
);
</script>
  </body>
</html>